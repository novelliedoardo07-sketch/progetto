<!DOCTYPE html>
<html>
<head>
  <meta charset="UTF-8">
  <title>Valutazione professori Majorana</title>
    <style>
/* ===== BASE ===== */
body {
    font-family: Arial, sans-serif;
    background: #f5f5f5;
    padding: 20px;
    margin: 0;
}

/* ===== TITOLI ===== */
h1 {
    color: #0000CD;
    text-align: center;
}

h2 {
    text-align: center;
    font-weight: bold;
}

h3 {
    text-align: center;
    font-weight: bold;
}

/* ===== TESTI ===== */
label {
    font-size: 16px;
    font-weight: normal;
}

/* ===== INPUT / TEXTAREA / SELECT ===== */
input,
select,
textarea {
    font-family: Arial, sans-serif;
    font-size: 15px;
    padding: 6px;
    margin-top: 5px;
    border-radius: 6px;
    border: 1px solid #bbb;
}

textarea {
    resize: none;
    display: block;
}

/* ===== BOTTONI ===== */
button {
    padding: 6px 12px;
    font-size: 14px;
    border-radius: 6px;
    cursor: pointer;
    border: 2px solid black;
    background-color: #0000CD;
    color: white;
    font-family: Arial, sans-serif;
}

button:hover {
    background-color: #00008B;
}

/* ===== SEZIONI ===== */
#login {
    margin-top: 20px;
}

#valutazione {
    margin-top: 20px;
}

/* ===== CASELLE VALUTAZIONE ===== */
.casella {
    margin-bottom: 15px;
}

.titoloCasella {
    font-weight: bold;
    font-size: 18px;
    margin-top: 10px;
}

/* ===== SELECT PROFESSORI ===== */
#professori {
    margin-top: 10px;
}

/* ===== LOGO ===== */
#logo {
    position: absolute;
    top: 10px;
    right: 10px;
    width: 80px;
    height: auto;
}

/* ===== CONTATTI ===== */
#contatti {
    position: fixed;
    bottom: 0;
    left: 0;
    width: 100%;
    background-color: #0000CD;
    color: white;
    padding: 15px;
    font-size: 14px;
    border-top: 2px solid black;
}

#contatti h4 {
    margin: 10px 0;
    font-weight: normal;
}

/* ===== ERRORI ===== */
#errore {
    color: red;
    font-weight: bold;
    text-align: center;
}
</style>
</head>
<body>

<script>
// Protezione accesso
if (localStorage.getItem("loggedIn") !== "true") {
    window.location.href = "login.html";
}
</script>

<p id="errore"></p>
<h1>Valutazione professori Majorana</h1>
<img src="logo.png" alt="logo scuola" id="logo">

<div id="valutazione">
    <label for="professori">Seleziona un professore:</label>
    <select id="professori">
      <option value="">--Scegli--</option>
      <option>Amato Grazia</option>
      <option>Annino Mauro</option>
      <option>Bonetti Rosaria</option>
      <option>Previtali Manuel</option>
      <option>Giocondo Pietro</option>
      <option>Lorenzi Stefano</option>
      <option>Raffaini Maria Grazia</option>
      <option>Nicolò Stefania Paola</option>
      <option>Manicone Filomena</option>
      <option>Titone Elisabetta</option>
      <option>Pievani Patrizia</option>
      <option>De Zuani Paolo</option>  
    </select>

    <button id="Invia">Invia tutte le valutazioni</button>

    <div id="caselleValutazione"></div>
</div>

<div id="contatti">
    <h2>I nostri contatti</h2>
    <h4>contiero.leonardo07@majorana.org</h4>
    <h4>nacuta.nicolas07@majorana.org</h4>
    <h4>novelli.edoardo07@majorana.org</h4>
    <h4>wassef.mena05@majorana.org</h4>
</div>

<script>
/* --- TUTTO IL TUO SCRIPT ORIGINALE, IDENTICO --- */
/* (Lo ricopio senza cambiare nulla tranne la parte login rimossa) */

const paroleVietate = [
    "cazzo","cazz0","c4zzo","coglione","stronzo","fottiti","vaffanculo",
    "fanculo","frocio","sparati","ammazzati","porca puttana","porco",
    "porca troia","troia","troiata","culo","figlio di puttana",
    "pezzo di merda","merda","bastardo","bastarda","zoccola",
    "lurido","sporco","rompe i coglioni","rompi palle","rompiscatole",
    "schifoso","idiota","cretino","imbecille","maniaco","pervertito",
    "negro","negraccio","zingaro","negra","terrone","terrona"
];

function gestisciParoleVietate(testo) {
    let testoPulito = testo;
    paroleVietate.forEach(parola => {
      const censura = "*".repeat(parola.length);
      testoPulito = testoPulito.replaceAll(parola, censura);
    });
    return testoPulito;
}

const professoriDaValutare = [
    "Amato Grazia","Annino Mauro","Bonetti Rosaria","Previtali Manuel",
    "Giocondo Pietro","Lorenzi Stefano","Raffaini Maria Grazia",
    "Nicolò Stefania Paola","Manicone Filomena","Titone Elisabetta",
    "Pievani Patrizia","De Zuani Paolo"
];

let feedbackSalvati = {};  
let ultimoProfSelezionato = null;

const selectProfessori = document.getElementById('professori');
const caselleDiv = document.getElementById('caselleValutazione');

selectProfessori.addEventListener('change', () => {
    const professoreSelezionato = selectProfessori.value;

    if (!professoreSelezionato) return;

    if (ultimoProfSelezionato !== null) {
        const pos = document.getElementById("textareaPos");
        const neg = document.getElementById("textareaNeg");

        if (pos && neg) {
            feedbackSalvati[ultimoProfSelezionato] = {
                positiva: pos.value,
                negativa: neg.value
            };
        }
    }

    ultimoProfSelezionato = professoreSelezionato;

    caselleDiv.innerHTML = '';

    const titoloPos = document.createElement('div');
    titoloPos.textContent = "Valutazione positiva";
    titoloPos.classList.add('titoloCasella');

    const textareaPos = document.createElement('textarea');
    textareaPos.id = "textareaPos";
    textareaPos.rows = 5;
    textareaPos.cols = 50;
    textareaPos.placeholder = `Scrivi qui la valutazione positiva per ${professoreSelezionato}...`;
    textareaPos.classList.add('casella');

    const titoloNeg = document.createElement('div');
    titoloNeg.textContent = "Valutazione negativa";
    titoloNeg.classList.add('titoloCasella');

    const textareaNeg = document.createElement('textarea');
    textareaNeg.id = "textareaNeg";
    textareaNeg.rows = 5;
    textareaNeg.cols = 50;
    textareaNeg.placeholder = `Scrivi qui la valutazione negativa per ${professoreSelezionato}...`;
    textareaNeg.classList.add('casella');

    caselleDiv.appendChild(titoloPos);
    caselleDiv.appendChild(textareaPos);
    caselleDiv.appendChild(titoloNeg);
    caselleDiv.appendChild(textareaNeg);

    if (feedbackSalvati[professoreSelezionato]) {
        textareaPos.value = feedbackSalvati[professoreSelezionato].positiva;
        textareaNeg.value = feedbackSalvati[professoreSelezionato].negativa;
    }

    [textareaPos, textareaNeg].forEach(textarea => {
      textarea.addEventListener('input', () => {
        const cursorPos = textarea.selectionStart;
        textarea.value = gestisciParoleVietate(textarea.value);
        textarea.selectionStart = textarea.selectionEnd = cursorPos;
      });
    });
});

const Invia = document.getElementById('Invia');
const errore = document.getElementById('errore');

Invia.addEventListener('click', () => {

    if (ultimoProfSelezionato !== null) {
        const pos = document.getElementById("textareaPos");
        const neg = document.getElementById("textareaNeg");

        if (pos && neg) {
            feedbackSalvati[ultimoProfSelezionato] = {
                positiva: pos.value,
                negativa: neg.value
            };
        }
    }

    let mancanti = [];

    for (let prof of professoriDaValutare) {
        if (!feedbackSalvati[prof] ||
            feedbackSalvati[prof].positiva.trim() === "" ||
            feedbackSalvati[prof].negativa.trim() === "") {

            mancanti.push(prof);
        }
    }

    if (mancanti.length > 0) {
        errore.textContent = "Mancano le valutazioni per: " + mancanti.join(", ");
        return;
    }

    errore.textContent = "";
    alert("Hai inviato tutte le valutazioni! Grazie!");

    localStorage.removeItem("loggedIn");
    window.location.href = "login.html";
});
</script>

</body>
</html>
